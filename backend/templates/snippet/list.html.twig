{% extends 'base.html.twig' %}

{% block title %}Snippets - My Ankode{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('css/snippets.css') }}">
{% endblock %}

{% block body %}

{# ========================================
   BLOC 1 : HEADER TITRE DE PAGE
   Position : En dessous de la navbar fixe
   Largeur : 100% sans bordure
   ======================================== #}
<header class="snippets-header">
    <h1 class="snippets-title">Snippets de code</h1>
    <p class="snippets-intro">
        Un snippet est un extrait de code réutilisable que tu peux sauvegarder pour gagner du temps. 
        Crée, organise et retrouve facilement tous tes morceaux de code favoris en un clin d'œil.
    </p>
</header>

{# ========================================
   CONTENEUR PRINCIPAL : BLOCS 2, 3, 4
   Layout Grid : Bloc 2 (config) | Bloc 3 (aside)
                 Bloc 4 (liste)   | Bloc 3 (aside)
   ======================================== #}
<main class="snippets-main">
    
    {# ========================================
       BLOC 2 : CONFIGURATION (Formulaire)
       État par défaut : OUVERT (expanded)
       Accordéon : Si ouvert, Bloc 4 est fermé
       ======================================== #}
    <section class="snippets-block snippets-block--config" id="config-block">
        
        {# ===== ÉTAT OUVERT : Formulaire complet visible ===== #}
        <div class="block-content block-content--expanded">
            <div class="block-header">
                <h2 class="block-title">Configuration</h2>
                
                {# Zone pour les messages flash (entre titre et bouton) #}
                <div class="block-flash-messages" id="config-flash-messages"></div>
            </div>
            
            {# ===== FORMULAIRE DE CRÉATION/ÉDITION ===== #}
            <form class="snippet-form" id="snippet-form">
                {# ID caché pour savoir si on est en mode édition #}
                <input type="hidden" id="snippet-id" name="id" value="">
                
                {# LIGNE 1 : Titre + Langage (côte à côte) #}
                <div class="form-row">
                    <div class="form-group">
                        <label for="snippet-title">Titre du snippet</label>
                        <input 
                            type="text" 
                            id="snippet-title" 
                            name="title" 
                            class="form-input" 
                            placeholder="Ex: Docker restart command" 
                            required
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="snippet-language">Langage</label>
                        <input 
                            type="text" 
                            id="snippet-language" 
                            name="language" 
                            class="form-input" 
                            placeholder="Ex: JavaScript, PHP, CSS..." 
                            required
                        >
                    </div>
                </div>
                
                {# LIGNE 2 : Code + Description (50/50 avec scrollbars) #}
                <div class="form-row form-row--split">
                    <div class="form-group form-group--half">
                        <label for="snippet-code">Code</label>
                        <textarea 
                            id="snippet-code" 
                            name="code" 
                            class="form-textarea form-textarea--code" 
                            placeholder="Colle ton code ici..." 
                            rows="10" 
                            required
                        ></textarea>
                    </div>
                    
                    <div class="form-group form-group--half">
                        <label for="snippet-description">Description</label>
                        <textarea 
                            id="snippet-description" 
                            name="description" 
                            class="form-textarea" 
                            placeholder="Décris à quoi sert ce snippet (optionnel)" 
                            rows="10"
                        ></textarea>
                    </div>
                </div>
                
                {# BOUTONS D'ACTION #}
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="btn-save-snippet">
                        Enregistrer
                    </button>
                    <button type="button" class="btn btn-secondary" id="btn-cancel-snippet">
                        Annuler
                    </button>
                </div>
            </form>
        </div>
        
        {# ===== ÉTAT RÉDUIT : Seulement la barre avec titre + bouton ===== #}
        <div class="block-content block-content--collapsed" style="display: none;">
            <div class="block-header">
                <h2 class="block-title">Configuration</h2>
                
                {# Bouton "Nouveau snippet" - VISIBLE UNIQUEMENT QUAND BLOC RÉDUIT #}
                <button class="btn-new-snippet" id="btn-new-snippet-collapsed">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Nouveau snippet
                </button>
                
                {# Bouton pour déplier le bloc #}
                <button class="btn-expand-config" id="btn-expand-config">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </button>
            </div>
        </div>
    </section>
    
    {# ========================================
       BLOC 3 : ASIDE RAPIDE (Raccourcis snippets)
       Position : Droite, en face des blocs 2 et 4
       Largeur : 200px (fixe)
       Hauteur : De la fin du bloc 1 jusqu'à la mascotte
       Toujours visible (pas d'accordéon)
       ======================================== #}
    <aside class="snippets-aside" id="snippets-aside">
        <h3 class="aside-title">Accès rapide</h3>
        <ul class="aside-list" id="aside-list">
            {# Sera rempli dynamiquement par JS #}
            <li class="aside-empty">Aucun snippet</li>
        </ul>
    </aside>
    
    {# ========================================
       BLOC 4 : LISTE DES SNIPPETS EXISTANTS
       État par défaut : RÉDUIT (collapsed)
       Accordéon : Si ouvert, Bloc 2 est fermé
       Tri : Par langage alphabétique, puis par titre (pas de séparateurs visuels)
       ======================================== #}
    <section class="snippets-block snippets-block--list" id="list-block">
        
        {# ===== ÉTAT RÉDUIT : Seulement la barre avec titre + bouton ===== #}
        <div class="block-content block-content--collapsed">
            <div class="block-header">
                <h2 class="block-title">Snippets existants</h2>
                
                {# Bouton pour déplier le bloc #}
                <button class="btn-expand-list" id="btn-expand-list">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                </button>
            </div>
        </div>
        
        {# ===== ÉTAT OUVERT : Liste complète des snippets ===== #}
        <div class="block-content block-content--expanded" style="display: none;">
            <div class="block-header">
                <h2 class="block-title">Snippets existants</h2>
                
                {# Bouton pour replier le bloc #}
                <button class="btn-collapse-list" id="btn-collapse-list">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
                    </svg>
                </button>
            </div>
            
            {# Container scrollable avec liste des snippets #}
            <div class="snippets-container" id="snippets-container">
                {# Sera rempli dynamiquement par JS #}
                <p class="empty-state">Aucun snippet pour le moment. Crée ton premier snippet ci-dessus !</p>
            </div>
        </div>
    </section>
    
</main>

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/snippets.js') }}"></script>
{% endblock %}
