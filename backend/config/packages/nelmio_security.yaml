nelmio_security:
    # Empêche le navigateur de deviner le type MIME
    content_type:
        nosniff: true
    
    # Protection contre le clickjacking (attaques par iframe)
    clickjacking:
        paths:
            '^/.*': DENY
    
    # Protection XSS (Cross-Site Scripting)
    xss_protection:
        enabled: true
        mode_block: true
    
    # Politique de référent HTTP
    referrer_policy:
        enabled: true
        policies:
            - 'strict-origin-when-cross-origin'
    
    # Content Security Policy (CSP)
    # Syntaxe nelmio : utiliser 'script' pas 'script-src'
    csp:
        enabled: true
        report_logger_service: monolog.logger.security
        
        hosts:
            # Sources autorisées par défaut
            - 'self'
        
        content_types:
            # Types de contenu sur lesquels appliquer CSP
            - 'text/html'
            - 'application/json'
        
        # Politique CSP
        enforce:
            # Niveau de sécurité
            level1_fallback: false
            browser_adaptive:
                enabled: false
            
            # Directives CSP (sans tirets, avec underscores)
            default-src:
                - 'self'
            script-src:
                - 'self'
            style-src:
                - 'self'
                - 'unsafe-inline'
            img-src:
                - 'self'
                - 'data:'
            font-src:
                - 'self'
            connect-src:
                - 'self'
            frame-ancestors:
                - "'none'"
            form-action:
                - 'self'
            base-uri:
                - 'self'